## ğŸ”‹ ç”µé‡æ˜¾ç¤ºä¿®å¤ - å¿«é€Ÿå¼€å§‹

### é—®é¢˜å·²ä¿®å¤ï¼âœ…

ä½ çš„å‰ç«¯ä»£ç ç°å·²ä¸åç«¯ `/api/robot/status` æ¥å£å®Œå…¨åŒ¹é…ã€‚

---

## ğŸš€ ç«‹å³éªŒè¯

### 1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·
æŒ‰ **F12** æ‰“å¼€æ§åˆ¶å° (Console)

### 2. æœç´¢ç”µæ± æ—¥å¿—
åœ¨æ§åˆ¶å°ä¸­æœç´¢å…³é”®è¯: `[Battery]`

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼çš„æ—¥å¿—:
```
[Battery] Starting battery status polling (interval: 2000ms)
[Battery] Polling /api/robot/status...
[Battery] API response received: {is_connected: true, status: "idle", battery: 82}
[Battery] Display set to: é›»é‡ï¼š82%
```

### 3. æ£€æŸ¥UIæ˜¾ç¤º
é¡µé¢å³ä¸Šè§’çš„ `#BtnBattery` æŒ‰é’®åº”è¯¥æ˜¾ç¤ºç”µé‡ï¼Œä¾‹å¦‚: **é›»é‡ï¼š82%**

---

## ğŸ“‹ ä¿®å¤æ¸…å•

### ä¿®æ”¹çš„ä»£ç 
- âœ… æ·»åŠ è¯¦ç»†è°ƒè¯•æ—¥å¿—
- âœ… æ”¯æŒä¸‰ç§è¯­è¨€çš„ç”µæ± æ–‡æœ¬
- âœ… ä¿æŠ¤ç”µæ± æ˜¾ç¤ºä¸è¢«è¦†ç›–
- âœ… æ”¹è¿›é”™è¯¯å¤„ç†
- âœ… æ”¯æŒå¤šç§æ•°æ®ç±»å‹è½¬æ¢

### æ–°å¢æ–‡ä»¶
- âœ… `BATTERY_DEBUG_GUIDE.md` - å®Œæ•´è°ƒè¯•æŒ‡å—
- âœ… `BATTERY_FIX_SUMMARY.md` - ä¿®å¤æ€»ç»“
- âœ… `test_battery_api.py` - APIæµ‹è¯•è„šæœ¬

---

## ğŸ” åç«¯æ¥å£è¦æ±‚

ç¡®ä¿ä½ çš„åç«¯è¿”å›ä»¥ä¸‹æ ¼å¼:

```json
GET /api/robot/status

{
  "is_connected": true,
  "status": "idle",
  "battery": 82
}
```

### å­—æ®µè¯´æ˜
| å­—æ®µ | ç±»å‹ | ä¾‹å­ | è¯´æ˜ |
|------|------|------|------|
| is_connected | boolean | true | è“ç‰™æ˜¯å¦è¿æ¥ |
| status | string | "idle" | ä»»åŠ¡çŠ¶æ€ (idle/running/paused) |
| battery | int\|null | 82 | ç”µé‡0-100 æˆ– null |

---

## ğŸ› ï¸ æµ‹è¯•API (å¯é€‰)

å¦‚æœä½ æœ‰Pythonç¯å¢ƒï¼Œè¿è¡Œæµ‹è¯•è„šæœ¬:

```bash
python test_battery_api.py
```

è¿™ä¼šæŒç»­è½®è¯¢APIï¼ŒéªŒè¯å“åº”æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚

---

## ğŸ¯ å…³é”®æ•°æ®æµ

```
åç«¯ â†’ /api/robot/status
  â†“
å‰ç«¯ fetchBatteryStatus()
  â†“
response.json()
  â†“
updateBatteryFromStatus(data)
  â†“
éªŒè¯ is_connected
  â†“
è§„èŒƒåŒ– battery å€¼
  â†“
setBatteryConnected() / setBatteryDisconnected()
  â†“
UI æ›´æ–°: é›»é‡ï¼šXX% (æˆ– é›»é‡ï¼š--)
```

---

## ğŸŒ å¤šè¯­è¨€æ”¯æŒ

ç”µæ± æ–‡æœ¬è‡ªåŠ¨é€‚åº”å½“å‰è¯­è¨€:

| è¯­è¨€ | è¿æ¥ | æ–­å¼€ |
|------|------|------|
| ç¹ä½“ä¸­æ–‡ (hant) | é›»é‡ï¼š82% | é›»é‡ï¼š-- |
| ç®€ä½“ä¸­æ–‡ (hans) | é›»é‡ï¼š82% | é›»é‡ï¼š-- |
| è‹±æ–‡ (en) | Battery: 82% | Battery: -- |

---

## ğŸ¨ UIæ ·å¼

### æ­£å¸¸çŠ¶æ€ (è¿æ¥)
- æ˜¾ç¤º: `é›»é‡ï¼š82%`
- é¢œè‰²: é»‘è‰²
- ç±»å: æ— 

### ä½ç”µé‡ (â‰¤20%)
- æ˜¾ç¤º: `é›»é‡ï¼š15%`
- é¢œè‰²: ğŸ”´ çº¢è‰²
- ç±»å: `.is-low`

### æœªè¿æ¥
- æ˜¾ç¤º: `é›»é‡ï¼š--`
- é¢œè‰²: ç°è‰²
- ç±»å: `.is-muted`

---

## âš™ï¸ é…ç½®å‚æ•°

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|---|----|
| BATTERY_POLL_MS | 2000 | è½®è¯¢é—´éš”(æ¯«ç§’) |
| BATTERY_LOW_THRESHOLD | 20 | ä½ç”µé‡é˜ˆå€¼(%) |
| APIè¶…æ—¶ | 1800ms | BATTERY_POLL_MS - 200 |

---

## ğŸ“ å¦‚æœè¿˜æœ‰é—®é¢˜

### æ£€æŸ¥æ¸…å•
- [ ] åç«¯ `/api/robot/status` æ­£åœ¨è¿è¡Œ
- [ ] è¿”å›çš„JSONæ ¼å¼æ­£ç¡®
- [ ] `is_connected` æ˜¯ boolean (true/false)
- [ ] `battery` æ˜¯ int (0-100) æˆ– null
- [ ] æµè§ˆå™¨æ§åˆ¶å°æ²¡æœ‰é”™è¯¯
- [ ] `#BtnBattery` HTMLå…ƒç´ å­˜åœ¨

### è°ƒè¯•æ­¥éª¤
1. æ‰“å¼€ F12 â†’ Console
2. æœç´¢ `[Battery]` å…³é”®è¯
3. æ£€æŸ¥API responseæ˜¯å¦æ­£ç¡®
4. æŸ¥çœ‹ Network æ ‡ç­¾ä¸­çš„ status è¯·æ±‚

### å¸¸è§é—®é¢˜
- **æ˜¾ç¤º"é›»é‡ï¼š--"** â†’ æ£€æŸ¥ `is_connected` å’Œ `battery` å€¼
- **ä¸æ›´æ–°ç”µé‡** â†’ æ£€æŸ¥APIæ˜¯å¦è¢«è°ƒç”¨ï¼ŒæŸ¥çœ‹ Network æ ‡ç­¾
- **æ˜¾ç¤ºè¢«è¦†ç›–** â†’ å·²ä¿®å¤ï¼Œ`setInnerTextIf()` ç°åœ¨ä¼šä¿æŠ¤ç”µæ± æ˜¾ç¤º

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

æŸ¥çœ‹ä»¥ä¸‹æ–‡ä»¶è·å–å®Œæ•´ä¿¡æ¯:

1. **BATTERY_FIX_SUMMARY.md** - ä¿®å¤æ€»ç»“å’ŒæŠ€æœ¯ç»†èŠ‚
2. **BATTERY_DEBUG_GUIDE.md** - å®Œæ•´çš„è°ƒè¯•æŒ‡å—
3. **test_battery_api.py** - APIæµ‹è¯•è„šæœ¬

---

## âœ¨ æ€»ç»“

ä¿®å¤å®Œæˆï¼ä½ çš„å‰ç«¯ç°åœ¨å·²ç»:

âœ… å®Œå…¨å…¼å®¹åç«¯API  
âœ… æ”¯æŒæ‰€æœ‰ä¸‰ç§è¯­è¨€  
âœ… åŒ…å«è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—  
âœ… å¯é çš„é”™è¯¯å¤„ç†  
âœ… è‡ªåŠ¨ç±»å‹è½¬æ¢  

äº«å—ä½ çš„ç”µé‡æ˜¾ç¤ºåŠŸèƒ½ï¼ğŸ‰
